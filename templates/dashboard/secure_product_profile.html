{% extends "dashboard/management_base.html" %}
{% load widget_tweaks %}


{% block page_css_style %}
    <link rel="stylesheet" type="text/css"
          href="/static/app-assets/vendors/css/tables/datatable/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" type="text/css"
          href="/static/app-assets/vendors/css/tables/extensions/rowReorder.dataTables.min.css">
    <link rel="stylesheet" type="text/css"
          href="/static/app-assets/vendors/css/tables/extensions/responsive.dataTables.min.css">
    <!-- BEGIN Page Level CSS-->
    <link rel="stylesheet" type="text/css" href="/static/app-assets/css/core/menu/menu-types/vertical-menu-modern.css">
    <link rel="stylesheet" type="text/css" href="/static/app-assets/css/core/colors/palette-gradient.css">
    <link rel="stylesheet" type="text/css" href="/static/app-assets/vendors/css/pickers/daterange/daterangepicker.css">
    <link rel="stylesheet" type="text/css" href="/static/app-assets/vendors/css/pickers/pickadate/pickadate.css">
    <link rel="stylesheet" type="text/css" href="/static/app-assets/css/core/menu/menu-types/vertical-menu-modern.css">
    <link rel="stylesheet" type="text/css" href="/static/app-assets/css/plugins/pickers/daterange/daterange.css">
    <link rel="stylesheet" type="text/css" href="/static/app-assets/vendors/css/forms/selects/select2.min.css">
    <!-- END Page Level CSS-->
{% endblock %}

{% block page_js %}
    <script src="/static/app-assets/vendors/js/tables/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="/static/app-assets/vendors/js/tables/datatable/dataTables.bootstrap4.min.js"
            type="text/javascript"></script>
    <script src="/static/app-assets/vendors/js/tables/datatable/dataTables.buttons.min.js"
            type="text/javascript"></script>
    <!-- BEGIN PAGE VENDOR JS-->
    <script src="/static/app-assets/vendors/js/charts/chart.min.js" type="text/javascript"></script>
    <script src="/static/app-assets/vendors/js/pickers/pickadate/picker.js" type="text/javascript"></script>
    <script src="/static/app-assets/vendors/js/pickers/pickadate/picker.date.js" type="text/javascript"></script>
    <script src="/static/app-assets/vendors/js/pickers/pickadate/picker.time.js" type="text/javascript"></script>
    <script src="/static/app-assets/vendors/js/pickers/pickadate/legacy.js" type="text/javascript"></script>
    <script src="/static/app-assets/vendors/js/pickers/dateTime/moment-with-locales.min.js"
            type="text/javascript"></script>
    <script src="/static/app-assets/vendors/js/pickers/daterange/daterangepicker.js"
            type="text/javascript"></script>

    <script src="/static/app-assets/js/core/libraries/jquery_ui/jquery-ui.min.js" type="text/javascript"></script>
    <script src="/static/app-assets/js/scripts/ui/jquery-ui/date-pickers.js" type="text/javascript"></script>
    <script src="/static/app-assets/vendors/js/forms/select/select2.full.min.js" type="text/javascript"></script>

    <script src="/static/app-assets/vendors/js/forms/toggle/switchery.min.js" type="text/javascript"></script>
    <script src="/static/app-assets/js/scripts/forms/select/form-select2.js" type="text/javascript"></script>
    <script src="/static/app-assets/vendors/js/forms/repeater/jquery.repeater.min.js"
            type="text/javascript"></script>
    <!-- END PAGE VENDOR JS-->
    <script src="/static/assets/js/products.js" type="text/javascript"></script>

    <script>
        jQuery(document).ready(function () {
            Products.init();
            Products.history();
            Products.statistic();
            Products.prices();
        });
    </script>
{% endblock %}



{% block content %}
    <div class="content-wrapper">
        <div class="content-header row">
            <div class="content-header-left col-md-6 col-12 mb-2 breadcrumb-new">
                <h3 class="content-header-title mb-0 d-inline-block">Products</h3>
                <div class="row breadcrumbs-top d-inline-block">
                    <div class="breadcrumb-wrapper col-12">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{% url 'secure.products' %}">Products</a>
                            </li>
                            <li class="breadcrumb-item active">Create Product
                            </li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
        <div class="content-body">
            <section id="justified-tabs-with-icons">
                <div class="row match-height">
                    <div class="col-xl-12 col-lg-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title" id="row-separator-icons">
                                    Timesheet</h4>
                                <a class="heading-elements-toggle"><i
                                        class="la la-ellipsis-h font-medium-3"></i></a>
                                <div class="heading-elements">
                                    <ul class="list-inline mb-0">
                                        <li><a data-action="expand"><i
                                                class="ft-maximize"></i></a></li>

                                    </ul>
                                </div>
                            </div>
                            <div class="card-content">
                                <div class="card-body">
                                    <div class="card-text">
                                        <p>Add <code>.row-separator</code> to form tag to add border bottom
                                            to a form-group. In this example <code>.form-horizontal</code> is used to
                                            show the row separator functionality.</p>
                                        {% if form.errors %}
                                            <div class="alert alert-danger alert-dismissible mb-2" role="alert">

                                                <h4 class="alert-heading mb-2">Error</h4>
                                                {% for field in form %}
                                                    {% for error in field.errors %}
                                                        <p class="mb-0">
                                                            <i class="fa ft-minus"></i>
                                                            {{ error|escape }}
                                                        </p>
                                                    {% endfor %}
                                                {% endfor %}
                                                {% for error in form.non_field_errors %}
                                                    <div class="alert alert-danger">
                                                        <p class="mb-0">
                                                            <i class="fa ft-minus"></i>
                                                            {{ error|escape }}
                                                        </p>

                                                    </div>
                                                {% endfor %}
                                            </div>
                                        {% endif %}
                                    </div>
                                    <ul class="nav nav-tabs nav-justified">
                                        <li class="nav-item">
                                            <a class="nav-link active" id="activeIcon-tab" data-toggle="tab"
                                               href="#activeIcon"
                                               aria-controls="activeIcon" aria-expanded="true"><i
                                                    class="la la-edit"></i>
                                                Info</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" id="linkIcon-tab" data-toggle="tab" href="#priceTab"
                                               aria-controls="linkIcon"
                                               aria-expanded="false"><i class="la la-money"></i> Prices/Unites</a>
                                        </li>


                                        <li class="nav-item">
                                            <a class="nav-link" id="linkIcon-tab" data-toggle="tab" href="#linkIcon"
                                               aria-controls="linkIcon"
                                               aria-expanded="false"><i class="la la-history"></i> History</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" id="statisticTab" data-toggle="tab"
                                               href="#linkOptIcon" aria-controls="linkOptIcon"><i
                                                    class="la la-line-chart"></i> Statistics</a>
                                        </li>
                                    </ul>
                                    <div class="tab-content px-1 pt-1">
                                        <div role="tabpanel" class="tab-pane active" id="activeIcon"
                                             aria-labelledby="activeIcon-tab"
                                             aria-expanded="true">
                                            <!-- Row separator layout section start -->
                                            <section id="row-separator-form-layouts">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="card">
                                                            <div class="card-content collapse show">
                                                                <div class="card-body">
                                                                    <form class="form form-horizontal" method="post"
                                                                          enctype="multipart/form-data">
                                                                        {% csrf_token %}
                                                                        <div class="form-body">
                                                                            <h4 class="form-section"><i
                                                                                    class="la la-commenting"></i>
                                                                                Product Infos</h4>
                                                                            <div class="row">
                                                                                <div class="col-md-6">
                                                                                    <div class="form-group">
                                                                                        <label>Name</label>
                                                                                        {{ form.name|add_class:"form-control"|attr:"placeholder:Product name" }}
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-md-6">
                                                                                    <div class="form-group">
                                                                                        <label>Article
                                                                                            Number</label>
                                                                                        {{ form.article_number|add_class:"form-control"|attr:"placeholder:Article number" }}
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="row">
                                                                                <div class="col-md-6">
                                                                                    <div class="form-group">
                                                                                        <label>Category</label>
                                                                                        {{ form.category|add_class:"form-control select2" }}
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-md-6">
                                                                                    <div class="form-group">
                                                                                        <label>Saison</label>
                                                                                        {{ form.offer_period|add_class:"form-control daterange"|attr:"placeholder:Periode" }}
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <h4 class="form-section"><i
                                                                                    class="la la-picture-o"></i> Product
                                                                                Descriptions</h4>
                                                                            <div class="row">
                                                                                <div class="col-md-6">
                                                                                    <div class="form-group">
                                                                                        <div class="col-md-12 col-xl-6">
                                                                                            <label>Image</label>
                                                                                            <figure>
                                                                                                <a href="#"
                                                                                                   data-size="480x360">
                                                                                                    <img class="img-thumbnail img-fluid"
                                                                                                         id="product_img"
                                                                                                         alt="Product image"
                                                                                                         src="{{ form.instance.image_url|default_if_none:'/static/app-assets/images/photo_default.png' }}"/>
                                                                                                </a>


                                                                                                <div class="img-options-box">
                                                                                                    <button class="btn btn-sm   btn-primary mb-1 dz-clickable"
                                                                                                            id="product-upload-btn">
                                                                                                        <i
                                                                                                                class="la la-cloud-upload"></i>
                                                                                                    </button>
                                                                                                    <button class="btn btn-sm  btn-secondary mb-1 dz-clickable"
                                                                                                            id="clear-product-input">
                                                                                                        <i class="la la-rotate-left"></i>
                                                                                                    </button>
                                                                                                    <button class="btn btn-sm btn-danger mb-1 dz-clickable"
                                                                                                            id="delete-product-image"
                                                                                                            data-id="{{ form.instance.pk }}">
                                                                                                        <i
                                                                                                                class="la la-trash"></i>
                                                                                                    </button>
                                                                                                </div>
                                                                                            </figure>
                                                                                            <div class="product_img_input_div">
                                                                                                {{ form.image|add_class:"form-control"|attr:"id:product_img_input"|attr:"aria-invalid:false" }}

                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-md-6">
                                                                                    <div class="form-group">
                                                                                        <label>Short Description</label>
                                                                                        {{ form.short_description|add_class:"form-control"|attr:"placeholder:"|attr:"rows:3"|attr:"maxlength:100" }}
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label>Long Description</label>
                                                                                        {{ form.description|add_class:"form-control"|attr:"placeholder:"|attr:"rows:8"|attr:"maxlength:300" }}
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-actions right">
                                                                            <button type="button"
                                                                                    class="btn btn-warning mr-1">
                                                                                <i class="ft-x"></i> Cancel
                                                                            </button>
                                                                            <button type="submit"
                                                                                    class="btn btn-primary">
                                                                                <i class="la la-check-square-o"></i>
                                                                                Save
                                                                            </button>
                                                                        </div>
                                                                    </form>
                                                                </div>
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>

                                            </section>
                                            <!-- // Row separator layout section end -->
                                        </div>
                                        <div class="tab-pane" id="priceTab" role="tabpanel"
                                             aria-labelledby="linkIcon-tab"
                                             aria-expanded="false">
                                            <section id="row-separator-form-layouts">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="card">
                                                            <div class="card-content collapse show">
                                                                <div class="card-body">
                                                                    <form method="post"
                                                                          action="/accounts/products/create/pricing/">
                                                                        {% csrf_token %}
                                                                        <input type="hidden" name="id" value="{{ id }}">
                                                                        <div class="form-body">
                                                                            <div class="form-group col-12 mb-2 contact-repeater">
                                                                                <div class="row"
                                                                                     data-repeater-list="repeater-group">
                                                                                    {% if not form.instance.active_units %}
                                                                                        <div class="col-md-12"
                                                                                             data-repeater-item>
                                                                                            <div class="row">
                                                                                                <div class="col-md-5">
                                                                                                    <div class="form-group">
                                                                                                        <label for="units">Unit</label>
                                                                                                        <select name="units"
                                                                                                                required
                                                                                                                id="units"
                                                                                                                class="select2">
                                                                                                            <option></option>
                                                                                                            <optgroup
                                                                                                                    label="Mass">
                                                                                                                <option
                                                                                                                        value="kg">
                                                                                                                    Kilogram
                                                                                                                </option>
                                                                                                                <option
                                                                                                                        value="g">
                                                                                                                    gram
                                                                                                                </option>
                                                                                                            </optgroup>
                                                                                                            <optgroup
                                                                                                                    label="Length">
                                                                                                                <option
                                                                                                                        value="mm">
                                                                                                                    Millimeter
                                                                                                                </option>
                                                                                                                <option
                                                                                                                        value="m">
                                                                                                                    Meter
                                                                                                                </option>
                                                                                                            </optgroup>
                                                                                                            <option
                                                                                                                    value="l">
                                                                                                                Litter
                                                                                                            </option>
                                                                                                        </select>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-md-5">
                                                                                                    <div class="form-group">
                                                                                                        <label for="price">Price</label>
                                                                                                        <input id="price"
                                                                                                               type="number"
                                                                                                               step="0.01"
                                                                                                               class="form-control"
                                                                                                               name="price"
                                                                                                               value=""/>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-md-2">
                                                                                                    <div class="form-group">
                                                                                                        <button type="button"
                                                                                                                style="margin-top: 27px"
                                                                                                                data-repeater-delete
                                                                                                                data-id="{{ unit.pk }}"
                                                                                                                class="btn btn-sm btn-danger mr-1">
                                                                                                            <i class="la la-remove"></i>
                                                                                                        </button>

                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>


                                                                                        </div>
                                                                                    {% endif %}
                                                                                    {% for unit in form.instance.active_units %}
                                                                                        <div class="col-md-12"
                                                                                             data-repeater-item>

                                                                                            <div class="row">
                                                                                                <div class="col-md-5">
                                                                                                    <div class="form-group">
                                                                                                        <label for="units">Unit</label>
                                                                                                        <select name="units"

                                                                                                                id="units"
                                                                                                                class="select2">
                                                                                                            <optgroup
                                                                                                                    label="Mass">
                                                                                                                <option {% if unit|lower ==  "kg" %}selected="selected" {% else %}
                                                                                                                        disabled {% endif %}
                                                                                                                        value="kg">
                                                                                                                    Kilogram
                                                                                                                </option>
                                                                                                                <option {% if unit|lower == "g" %}selected="selected"{% else %}
                                                                                                                        disabled {% endif %}
                                                                                                                        value="g">
                                                                                                                    gram
                                                                                                                </option>
                                                                                                            </optgroup>
                                                                                                            <optgroup
                                                                                                                    label="Length">
                                                                                                                <option {% if unit|lower == "mm" %}selected="selected"{% else %}
                                                                                                                        disabled {% endif %}
                                                                                                                        value="mm">
                                                                                                                    Millimeter
                                                                                                                </option>
                                                                                                                <option {% if unit|lower == "m" %}selected="selected"{% else %}
                                                                                                                        disabled {% endif %}
                                                                                                                        value="m">
                                                                                                                    Meter
                                                                                                                </option>
                                                                                                            </optgroup>
                                                                                                            <option {% if unit|lower == "l" %}selected="selected"{% else %}
                                                                                                                    disabled {% endif %}
                                                                                                                    value="l">
                                                                                                                Litter
                                                                                                            </option>

                                                                                                        </select>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-md-5">
                                                                                                    <div class="form-group">
                                                                                                        <label for="price">Price</label>
                                                                                                        <input id="price"
                                                                                                               type="number"
                                                                                                               step="0.01"
                                                                                                               class="form-control"
                                                                                                               name="price"
                                                                                                               value="{{ unit.price }}"/>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-md-2">
                                                                                                    <div class="form-group">
                                                                                                        <button type="button"
                                                                                                                style="margin-top: 27px"
                                                                                                                data-repeater-delete
                                                                                                                data-id="{{ unit.pk }}"
                                                                                                                class="btn btn-sm btn-danger mr-1">
                                                                                                            <i class="la la-remove"></i>
                                                                                                        </button>

                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>


                                                                                        </div>
                                                                                    {% endfor %}

                                                                                </div>
                                                                                <button type="button"
                                                                                        data-repeater-create
                                                                                        class="btn btn-primary">
                                                                                    <i class="ft-plus"></i> Add
                                                                                    Price/Unit
                                                                                </button>
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-actions right">
                                                                            <div class="right">
                                                                                <button type="button"
                                                                                        class="btn btn-warning mr-1">
                                                                                    <i class="ft-x"></i> Cancel
                                                                                </button>
                                                                                <button type="submit"
                                                                                        class="btn btn-primary">
                                                                                    <i class="la la-check-square-o"></i>
                                                                                    Save
                                                                                </button>
                                                                            </div>

                                                                        </div>
                                                                    </form>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </section>
                                        </div>
                                        <div class="tab-pane" id="linkIcon" role="tabpanel"
                                             aria-labelledby="linkIcon-tab"
                                             aria-expanded="false">

                                            <div class="table-responsive">
                                                <table id="orders_table"
                                                       data-id="{{ id }}"
                                                       class="table table-white-space  table-bordered no-wrap icheck table-middle"
                                                >
                                                    <thead>
                                                    <tr>
                                                        <th>Invoice</th>
                                                        <th>Client</th>
                                                        <th>Number of Products</th>
                                                        <th>Amount ordered</th>

                                                        <th>State</th>
                                                        <th>Date</th>
                                                    </tr>
                                                    </thead>

                                                </table>
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="linkOptIcon" role="tabpanel"
                                             aria-labelledby="linkOptIcon-tab"
                                             aria-expanded="false">
                                            <div class="row">
                                                <div class="col-xl-6 col-md-12">
                                                    <div class="card overflow-hidden">
                                                        <div class="card-content">
                                                            <div class="media align-items-stretch bg-gradient-x-info text-white rounded">
                                                                <div class="p-2 media-middle">
                                                                    <i class="ft-trending-up font-large-2 text-white"></i>
                                                                </div>
                                                                <div class="media-body p-2">
                                                                    <h4 class="text-white">Total Orders</h4>
                                                                    <span>Times it was ordered</span>
                                                                </div>
                                                                <div class="media-right p-2 media-middle">
                                                                    <h1 class="text-white" id="total-orders">0</h1>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-xl-6 col-md-12">
                                                    <div class="card">
                                                        <div class="card-content">
                                                            <div class="media align-items-stretch bg-gradient-x-warning text-white rounded">
                                                                <div class="p-2 media-middle">
                                                                    <i class="la la-certificate font-large-2 text-white"></i>
                                                                </div>
                                                                <div class="media-body p-2">
                                                                    <h4 class="text-white">Total Amount</h4>
                                                                    <span>Sum of amount ordered</span>
                                                                </div>
                                                                <div class="media-right p-2 media-middle">
                                                                    <h1 class="text-white" id="sum-orders">0</h1>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <form style="width: 100%">
                                                    <fieldset class="options">
                                                        <legend class="olabel"><i class="la la-gears"></i> Options
                                                        </legend>
                                                        <input type="hidden" id="statistic-product" value="{{ id }}">
                                                        <div class="col-md-6" style="float: left">
                                                            <div class="form-group">
                                                                <label><i class="la la-calendar-o"></i> Period</label>
                                                                <input class="form-control daterange" placeholder=""
                                                                       id="statistic-period"/>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-6" style="float: left">
                                                            <div class="form-group">
                                                                <label><i class="la la-sort-numeric-asc"></i>
                                                                    Interval</label>
                                                                <select class="select2" id="statistic-interval">
                                                                    <option selected>Daily</option>
                                                                    <option>Monthly</option>
                                                                    <option>Yearly</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </fieldset>
                                                </form>
                                            </div>
                                            <div class="row">
                                                <div class="col-12">
                                                    <canvas id="column-chart"
                                                            style="height: 400px !important; width: 500px"></canvas>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </div>
    <div class="modal animated slideInLeft text-left" tabindex="-1"
         id="remove-confirm-modal"
         role="dialog" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="myModalLabel75">Please confirm your action</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="right">
                        <button type="button" class="btn btn-sm grey btn-outline-secondary right" data-dismiss="modal">
                            Cancel
                        </button>
                        <button type="button" class="btn btn-sm btn-success" id="remove-confirm-action"
                                style="float: right">Confirm
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </div>

{% endblock %}